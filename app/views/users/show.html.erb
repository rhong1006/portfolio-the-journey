
<div class="row space-from-top">
  <div class="col-sm-3" style="border-right: 1px dashed #333;">
    <div class="user-profile">
      <p>
        <strong>Username:</strong><%= @user.username %>
      </p>
      <p>
        <strong>Email:</strong><%= @user.email %>
      </p>

      <%= link_to fa_icon("edit 2x"), edit_user_path(@user) %> |
    </div>
  </div>

  <div class="col-sm-8 my-trips">
    <div style="margin-bottom: 16px;">
      <span class="title">MY TRIPS</span>
      <!-- BootStrap Modal Button: Add New Trip -->
      <div class="float-right" data-toggle="modal" data-target='#newTripModal'>
        <%= fa_icon "paper-plane 2x"  %>
        <span>New Trip</span>
      </div>
    </div>

    <!-- BootStrap Modal: Add New Trip -->
    <div class="modal fade" id="newTripModal" tabindex="-1" role="dialog" aria-labelledby="tripModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="tripModalLabel">New Trip</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <%= form_for @trip do |form|  %>
              <% if @trip.errors.present? %>
                <p><%= @trip.errors.full_messages.join(', ') %></p>
              <% end %>
              <div>
                <%= form.label :title %>
                <%= form.text_field :title,  class:"form-control" %>
              </div>
              <div class="modal-footer">
                <button type="submit" class="btn btn-primary">Submit</button>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- All Trips owned by the current_user-->
    <div class="row">
      <% @trips.each do |trip| %>
        <% route_locations = [] %>
        <% trip.routes.order(start_date: :asc).each do |route| %>
          <% route_locations << route.lat_lng_string %>
        <% end %>

        <div class="col-md-4">
          <div class="card mb-4 box-shadow">
            <img style="border-radius:3px;" src="https://maps.googleapis.com/maps/api/staticmap?size=150x200&amp;mobile=true&path=color:0x333333ff|weight:3<%=route_locations.join()%>&markers=color:red|label:S<%=route_locations.first%>&markers=color:red|label:E<%=route_locations.last%>&key=<%=ENV['GOOGLE_STATIC_MAP_API_SECRET']%>&style=feature:administrative%7Celement:geometry.stroke%7Ccolor:0xb8b8b8%7Cvisibility:on%7Cweight:1&style=feature:administrative%7Celement:labels.text.fill%7Ccolor:0x6195a0&style=feature:administrative.province%7Celement:geometry.stroke%7Cvisibility:off&style=feature:landscape%7Celement:geometry%7Ccolor:0xfffef5&style=feature:landscape.man_made%7Clightness:-5&style=feature:landscape.natural.terrain%7Cvisibility:off&style=feature:poi%7Cvisibility:off&style=feature:poi.park%7Celement:geometry.fill%7Ccolor:0xbae5ce%7Cvisibility:on&style=feature:road%7Csaturation:-100%7Clightness:45%7Cvisibility:simplified&style=feature:road.arterial%7Cvisibility:off&style=feature:road.highway%7Cvisibility:off&amp;style=feature:transit%7Cvisibility:simplified&amp;style=feature:water%7Ccolor:0xc2f1f5%7Csaturation:35%7Clightness:40%7Cgamma:0.42%7Cvisibility:on&amp;style=feature:water%7Celement:labels.text.fill%7Ccolor:0xadadad%7Cvisibility:on&amp;scale=2">
            <div class="card-body">
              <p><%= trip.title %></p>
              <p><%= trip.user.username %></p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                  <%= link_to 'View', trip_path(trip), class:"btn btn-sm btn-outline-secondary" %>
                  <%= link_to 'Edit', edit_trip_path(trip), class:"btn btn-sm btn-outline-secondary" %>
                </div>
                <small class="text-muted">
                  <%= image_tag 'hearts.png', style: 'width: 33px; height: 33px; border-radius: 5px;' %>
                  <%= pluralize(trip.like_count, 'like') %>
                </small>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
